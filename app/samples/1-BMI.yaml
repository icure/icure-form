form: test-forms.BMI
id: c789794e-d0f4-8988-1234-e758a782473b
description: test-forms.BMI
sections:
  - section: main
    fields:
      - field: weight
        type: measure-field
        shortLabel: Weight
        computedProperties:
          defaultValue: |
            return { content: { '*': { type: 'measure', unit: 'kg' } }, codes: [] }
      - field: height
        type: measure-field
        shortLabel: Height
        computedProperties:
          defaultValue: |
            return { content: { '*': { type: 'measure', unit: 'cm' } }, codes: [] }
      - field: bmi
        type: measure-field
        shortLabel: BMI
        readonly: true
        computedProperties:
          value: |
            const w = parseContent(weight[0]?.content)
            let h = parseContent(height[0]?.content)
            if (!w || !h) { return undefined }
            if (h > 3) { h = h / 100 } 
            return { content: { '*': { type: 'measure', value: w / (h * h) } }, codes: [] }
      - field: bmi-default
        type: measure-field
        shortLabel: default BMI
        computedProperties:
          defaultValue: |
            return { value: 10, unit: 'cm' }
      - field: bmiDelayedDependence
        type: text-field
        shortLabel: Del. BMI stat.
        computedProperties:
          value: |
            return new Promise(async (resolve) => {
              await delay(1000)
              const bmic = parseContent(bmi[0]?.content)
              if (!bmic) { resolve('N/A') }
              resolve(bmi < 15 ? 'too thin' : bmic>25 ? 'too fat' : 'good')
            })
      - field: bmiDelayedDependence2
        type: text-field
        shortLabel: Del. BMI stat. 2
        computedProperties:
          value: |
            return new Promise(async (resolve) => {
              await delay(500)
              const bmic = parseContent(bmiDelayedDependence[0]?.content)
              if (!bmic) { resolve('N/A') }
              resolve(bmic+'!')
            })
            
            



